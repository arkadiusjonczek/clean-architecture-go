<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Basket</title>
    </head>
    <body>
        <h1>Basket</h1>
        {{ if .message }}
        <p>{{ .message }}</p>
        {{ end }}
        {{ if .userBasket }}
        {{ if .userBasket.Items }}
        <table border="1">
            <tr>
                <th>Count</th>
                <th>Product</th>
                <th>Price</th>
            </tr>
        {{ range .userBasket.Items }}
            <tr>
                <td>{{ .Count }}</td>
                <td>{{ .Product.Name }}</td>
                <td>{{ .Product.Price.Value }} {{ .Product.Price.Currency }}</td>
            </tr>
        {{ end }}
        </table>
        <button onclick="javascript:clearBasket();">Clear</button>
        {{ else }}
        <p>The basket is empty.</p>
        {{ end }}
        {{ end }}
    </body>
</html>
<script>
    function clearBasket() {
        if (!confirm("Are you sure?")) {
            return;
        }
        const request = new Request("/basket", {method: "DELETE"});

        fetch(request)
            .then((response) => {
                if (response.status !== 200) {
                    throw new Error("Something went wrong on API server!");
                }
                console.debug(response);
                location.reload();
            })
            .catch((error) => {
                console.error(error);
            });
    }
</script>